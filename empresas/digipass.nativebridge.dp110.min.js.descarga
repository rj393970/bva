/**
 * Copyright (c) since 2018. OneSpan Inc.
 * All rights reserved. https://www.onespan.com
 *
 * @license OneSpan Inc.
 */
var digipass=digipass||{};digipass.nativebridge=digipass.nativebridge||{};digipass.nativebridge.DP110=function(){"use strict";var e;var i;var t;this.version="2.7.4";this.versionCode=20704;this.useFallback=function(){t=false};this.onReady=function(i){e=i;return this};this.onError=function(e){i=e;return this};this.close=function(){if(o)o.close()};this.reconnect=function(){c()};this.isReady=function(){return o&&o.readyState==1};this.isFallback=function(){return a};this.getNativeBridgeVersion=function(e){d("core.getNativeBridgeVersion",{},e)};this.getNativeBridgeAttributes=function(e){d("core.getNativeBridgeAttributes",{},e)};var n=this;var o;var a=false;var r={};var s={};var f=false;if(!digipass.nativebridge.config&&!digipass.nativebridge.config_ext)throw"The configuration file 'digipass.nativebridge.config.min.js' has not been loaded";n.useFallback();c();function c(){f=false;if(sessionStorage){if(sessionStorage.wssPort){try{h(sessionStorage.wssPort,function(e){if(!e){sessionStorage.clear();return}o=e;o.onclose=function(){o=null;if(f){f=false;setTimeout(c,3e3)}else if(i)i(n)};o.onerror=function(){o.close()};o.onmessage=function(e){g(JSON.parse(e.data))};b()});setTimeout(u,3e3)}catch(e){sessionStorage.clear()}}else if(sessionStorage.wsPort&&t==true){try{S(sessionStorage.wsPort,function(e){if(!e){sessionStorage.clear();return}o=e;o.onclose=function(){o=null;if(f){f=false;setTimeout(c,3e3)}else if(i)i(n)};o.onerror=function(){o.close()};o.onmessage=function(e){g(JSON.parse(e.data))};b()});setTimeout(u,3e3)}catch(e){sessionStorage.clear()}}else{u()}}else{u()}}function u(){if(!o){v(function(e){if(!e){if(t==true){p(function(e){if(!e){if(i)i(n);return}o=e;o.onclose=function(){o=null;if(f){f=false;setTimeout(c,3e3)}else if(i)i(n)};o.onerror=function(){o.close()};o.onmessage=function(e){g(JSON.parse(e.data))};b()})}else{if(i)i(n);return}}else{o=e;o.onclose=function(){o=null;if(f){f=false;setTimeout(c,3e3)}else if(i)i(n)};o.onerror=function(){o.close()};o.onmessage=function(e){g(JSON.parse(e.data))};b()}})}}function l(){f=false;if(e)e(n)}function d(e,i,t){if(!n.isReady()){console.log("[digipass-native-bridge] Request aborted, the bridge is not yet ready.");return}var a=Math.ceil(Math.random()*920704+120704).toString();r[a]=t;var s={type:"request",id:a,api:e,data:i};o.send(JSON.stringify(s))}function g(e){if(e.data&&e.data.integrationError){var i="[digipass-native-bridge] Integration error: ";console.log(i+e.data.integrationError)}if(e.type=="response"){var t=r[e.id];if(!t)return;delete r[e.id];t(e.data)}if(e.type=="event"){var t=s[e.event];if(!t)return;t(e.data)}}function v(e){var i=["42579","35739","36811","39582","45250","46028"];var t;if(localStorage){t=localStorage.getItem("digipass.nativebridge.preferredSecurePort")}if(t){var n=i.indexOf(t);if(n>0){i.splice(n,1);i.unshift(t)}}h(i[0],function(t){if(t){e(t);return}var n=1;var o=false;for(var a=1;a<i.length;++a){(function(t){h(i[t],function(a){if(a){if(localStorage){localStorage.setItem("digipass.nativebridge.preferredSecurePort",i[t])}e(a);o=true}if(++n==i.length&&!o){e()}})})(a)}})}function p(e){var i=["42580","35740","36812","39583","45251","46029"];var t;if(localStorage){t=localStorage.getItem("digipass.nativebridge.preferredFallbackPort")}if(t){var n=i.indexOf(t);if(n>0){i.splice(n,1);i.unshift(t)}}S(i[0],function(t){if(t){e(t);return}var n=1;var o=false;for(var a=1;a<i.length;++a){(function(t){S(i[t],function(a){if(a){if(localStorage){localStorage.setItem("digipass.nativebridge.preferredFallbackPort",i[t])}e(a);o=true}if(++n==i.length&&!o){e()}})})(a)}})}function h(e,i){var t=null;var n=false;try{t=new WebSocket("wss://localhost.vdsnb.com:"+e)}catch(o){r();throw o}t.onmessage=function(o){if(o.data=="Hello from DIGIPASS Native Bridge!"){n=true;if(sessionStorage){sessionStorage.wssPort=e}a=false;i(t)}};t.onopen=function(){setTimeout(r,1e3)};t.onerror=function(){r()};t.onclose=function(){r()};if(navigator.userAgent.indexOf("Firefox")!=-1)setTimeout(r,17500);else setTimeout(r,5e3);function r(){if(!n){n=true;if(t)t.close();i()}}}function S(e,i){var t=null;var n=false;try{t=new WebSocket("ws://127.0.0.1:"+e)}catch(o){r();throw o}t.onmessage=function(o){if(o.data=="Hello from DIGIPASS Native Bridge!"){n=true;a=true;if(sessionStorage){sessionStorage.wsPort=e}i(t)}};t.onopen=function(){setTimeout(r,1e3)};t.onerror=function(){r()};t.onclose=function(){r()};if(navigator.userAgent.indexOf("Firefox")!=-1)setTimeout(r,17500);else setTimeout(r,5e3);function r(){if(!n){n=true;if(t)t.close();i()}}}function b(){var e=digipass.nativebridge.config;var i=digipass.nativebridge.config_ext;var t={};var n={};if(e&&e.data||i&&i.data){if(e&&e.data){var o=e.data.indexOf("\n");var a=parseInt(e.data.substring(0,o));t.version=a;n.data=e.data}if(i&&i.data){var o=i.data.indexOf("\n");var a=parseInt(i.data.substring(0,o));t.version_ext=a;n.data_ext=i.data}d("core.updateConfig",t,function(e){if(e.updateNeeded){f=true;d("core.updateConfig",n,function(){l()})}else{l()}})}else{l()}}function m(){if(o){o.onclose=function(){};if(navigator.userAgent.indexOf("Safari/")!=-1){o.close();o=null}}}window.addEventListener("unload",m);window.addEventListener("pagehide",m);window.addEventListener("beforeunload",function(){});this.getTokenInfo=function(e,i){var t={commandId:e};d("dp110.getTokenInfo",t,i)};this.generateOTP=function(e,i,t){var n={staticVector:e,challenge:i};d("dp110.generateOTP",n,t)}};
//# sourceMappingURL=digipass.nativebridge.dp110.min.map